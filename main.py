
import streamlit as st
import datetime

zodiacs = ["é¼ ","ç‰›","è™","å…”","é¾™","è›‡","é©¬","ç¾Š","çŒ´","é¸¡","ç‹—","çŒª"]
tiangans = ["ç”²","ä¹™","ä¸™","ä¸","æˆŠ","å·±","åºš","è¾›","å£¬","ç™¸"]
dizhis = ["å­","ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"]

nayin_map = {
    ("ç”²å­","ä¹™ä¸‘"): ("æµ·ä¸­é‡‘", "é‡‘"), ("ä¸™å¯…","ä¸å¯"): ("ç‚‰ä¸­ç«", "ç«"),
    ("æˆŠè¾°","å·±å·³"): ("å¤§æ—æœ¨", "æœ¨"), ("åºšåˆ","è¾›æœª"): ("è·¯æ—åœŸ", "åœŸ"),
    ("å£¬ç”³","ç™¸é…‰"): ("å‰‘é”‹é‡‘", "é‡‘"), ("ç”²æˆŒ","ä¹™äº¥"): ("å±±å¤´ç«", "ç«"),
    ("ä¸™å­","ä¸ä¸‘"): ("æ¶§ä¸‹æ°´", "æ°´"), ("æˆŠå¯…","å·±å¯"): ("åŸå¤´åœŸ", "åœŸ"),
    ("åºšè¾°","è¾›å·³"): ("ç™½èœ¡é‡‘", "é‡‘"), ("å£¬åˆ","ç™¸æœª"): ("æ¨æŸ³æœ¨", "æœ¨"),
    ("ç”²ç”³","ä¹™é…‰"): ("æ³‰ä¸­æ°´", "æ°´"), ("ä¸™æˆŒ","ä¸äº¥"): ("å±‹ä¸ŠåœŸ", "åœŸ"),
    ("æˆŠå­","å·±ä¸‘"): ("éœ¹é›³ç«", "ç«"), ("åºšå¯…","è¾›å¯"): ("æ¾æŸæœ¨", "æœ¨"),
    ("å£¬è¾°","ç™¸å·³"): ("é•¿æµæ°´", "æ°´"), ("ç”²åˆ","ä¹™æœª"): ("æ²™ä¸­é‡‘", "é‡‘"),
    ("ä¸™ç”³","ä¸é…‰"): ("å±±ä¸‹ç«", "ç«"), ("æˆŠæˆŒ","å·±äº¥"): ("å¹³åœ°æœ¨", "æœ¨"),
    ("åºšå­","è¾›ä¸‘"): ("å£ä¸ŠåœŸ", "åœŸ"), ("å£¬å¯…","ç™¸å¯"): ("é‡‘ç®”é‡‘", "é‡‘"),
    ("ç”²è¾°","ä¹™å·³"): ("è¦†ç¯ç«", "ç«"), ("ä¸™åˆ","ä¸æœª"): ("å¤©æ²³æ°´", "æ°´"),
    ("æˆŠç”³","å·±é…‰"): ("å¤§é©¿åœŸ", "åœŸ"), ("åºšæˆŒ","è¾›äº¥"): ("é’—é’é‡‘", "é‡‘"),
    ("å£¬å­","ç™¸ä¸‘"): ("æ¡‘æŸ˜æœ¨", "æœ¨"), ("ç”²å¯…","ä¹™å¯"): ("å¤§æºªæ°´", "æ°´"),
    ("ä¸™è¾°","ä¸å·³"): ("æ²™ä¸­åœŸ", "åœŸ"), ("æˆŠåˆ","å·±æœª"): ("å¤©ä¸Šç«", "ç«"),
    ("åºšç”³","è¾›é…‰"): ("çŸ³æ¦´æœ¨", "æœ¨"), ("å£¬æˆŒ","ç™¸äº¥"): ("å¤§æµ·æ°´", "æ°´")
}

def get_ganzhi(year):
    gan_index = (year - 4) % 10
    zhi_index = (year - 4) % 12
    return tiangans[gan_index] + dizhis[zhi_index]

def get_zodiac(year):
    return zodiacs[(year - 4) % 12]

def get_nayin(ganzhi):
    for key, value in nayin_map.items():
        if ganzhi in key:
            return value
    return ("æœªçŸ¥", "æœªçŸ¥")

def run_analysis(man_date, woman_date):
    my, wy = man_date.year, woman_date.year
    m_zodiac, w_zodiac = get_zodiac(my), get_zodiac(wy)
    m_gz, w_gz = get_ganzhi(my), get_ganzhi(wy)
    m_nayin, w_nayin = get_nayin(m_gz)[0], get_nayin(w_gz)[0]
    return f"ğŸ‘¦ ç”·æ–¹ï¼š{my}å¹´ å±{m_zodiac} çº³éŸ³ï¼š{m_nayin}\n"            f"ğŸ‘§ å¥³æ–¹ï¼š{wy}å¹´ å±{w_zodiac} çº³éŸ³ï¼š{w_nayin}\n"            f"ğŸ“Š é…å¯¹ç®€æï¼š{m_zodiac}é…{w_zodiac}ï¼Œçº³éŸ³äº”è¡Œä¸ºã€{m_nayin}ã€‘é…ã€{w_nayin}ã€‘ã€‚"

def main():
    st.set_page_config(page_title="è‰¯ç¼˜å©šé…åˆ†æå¸ˆ", page_icon="ğŸ’˜")
    st.title("ğŸ’˜ è‰¯ç¼˜å©šé…åˆ†æå¸ˆ")
    st.markdown("ä¾æ®å‡ºç”Ÿå¹´æ¨æ¼”ç”Ÿè‚–ä¸çº³éŸ³äº”è¡Œï¼Œå¿«é€Ÿå©šé…è¯„ä¼°")

    col1, col2 = st.columns(2)
    with col1:
        man_date = st.date_input("ç”·æ–¹å‡ºç”Ÿæ—¥æœŸ", datetime.date(1990,1,1))
    with col2:
        woman_date = st.date_input("å¥³æ–¹å‡ºç”Ÿæ—¥æœŸ", datetime.date(1992,1,1))

    if st.button("ğŸ”® å¼€å§‹é…å¯¹åˆ†æ"):
        result = run_analysis(man_date, woman_date)
        st.markdown("### ğŸ“‹ é…å¯¹ç»“æœï¼š")
        st.code(result)

if __name__ == "__main__":
    main()
    